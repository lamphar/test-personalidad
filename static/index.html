<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test de Personalidad Real</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body {
      background: linear-gradient(to right, #f8f9fa, #e0f7fa);
      font-family: 'Segoe UI', sans-serif;
    }
    .card {
      border: none;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    .btn-primary {
      background-color: #00695c;
      border: none;
    }
    .btn-primary:hover {
      background-color: #004d40;
    }
    .btn-success {
      background-color: #43a047;
      border: none;
    }
    .btn-success:hover {
      background-color: #2e7d32;
    }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="card p-4">
      <h1 class="text-center mb-4">üßò Test de Estoicismo</h1>
      <p class="text-center">Este test eval√∫a tu grado de alineaci√≥n con principios estoicos, como autocontrol, aceptaci√≥n, disciplina y reflexi√≥n racional, con base en literatura cient√≠fica sobre bienestar psicol√≥gico.</p>

      <form id="testForm">
        <div id="questionsContainer"></div>

        <div class="mb-3">
          <label for="email" class="form-label">Introduce tu correo para recibir los resultados:</label>
          <input type="email" class="form-control" id="email" name="email" required>
        </div>

        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" id="terms" required>
          <label class="form-check-label" for="terms">
            Acepto los <a href="/terminos.html" target="_blank">t√©rminos y condiciones</a> y la <a href="/privacidad.html" target="_blank">pol√≠tica de privacidad</a>.
          </label>
        </div>

        <button type="submit" class="btn btn-primary w-100">Solicitar an√°lisis estoico</button>
      </form>

      <div id="paymentSection" class="mt-4 d-none">
        <div class="alert alert-info">
          <strong>¬°Gracias!</strong> Para ayudarte a sostener este servicio independiente y √©tico, te pedimos una cooperaci√≥n simb√≥lica de 0.50‚Ç¨.
        </div>
        <a href="https://buy.stripe.com/test_donation_link" class="btn btn-success w-100">Colaborar y recibir resultados</a>
        <p class="text-muted mt-2 text-center" style="font-size: 0.9em;">Nunca suscribimos a nadie autom√°ticamente. No hay pagos ocultos. Siempre podr√°s acceder a los resultados sin compromisos posteriores.</p>
      </div>
    </div>
  </div>

  <script>
    const preguntas = [
      "1. Suelo mantener la calma ante situaciones dif√≠ciles.",
      "2. Acepto aquello que no puedo controlar sin resistirme.",
      "3. Reflexiono antes de reaccionar emocionalmente.",
      "4. Me esfuerzo por ser virtuoso m√°s que exitoso.",
      "5. No me altero f√°cilmente por lo que otros opinan de m√≠.",
      "6. Evito el placer excesivo porque s√© que es ef√≠mero.",
      "7. Afronto el sufrimiento con dignidad.",
      "8. Soy disciplinado con mis h√°bitos diarios.",
      "9. Pongo la raz√≥n por encima del impulso.",
      "10. Encuentro sentido en actuar correctamente, incluso si nadie lo nota.",
      "11. Me preparo mentalmente para adversidades.",
      "12. Trato de conocerme a m√≠ mismo con honestidad.",
      "13. Encuentro libertad en aceptar mi destino.",
      "14. Reconozco mis errores sin juzgarme duramente.",
      "15. No envidio los logros materiales de los dem√°s.",
      "16. Agradezco lo que tengo, aunque sea poco.",
      "17. S√© distinguir entre deseo y necesidad.",
      "18. Me esfuerzo por mantenerme ecu√°nime.",
      "19. Uso las dificultades como oportunidades para crecer.",
      "20. Valoro m√°s la paz interior que el reconocimiento externo."
    ];

    const container = document.getElementById('questionsContainer');
    preguntas.forEach((texto, i) => {
      const div = document.createElement('div');
      div.className = 'mb-3';
      div.innerHTML = `
        <label class="form-label">${texto}</label>
        <select class="form-select" name="q${i + 1}">
          <option value="1">Nunca</option>
          <option value="2">Rara vez</option>
          <option value="3">A veces</option>
          <option value="4">A menudo</option>
          <option value="5">Siempre</option>
        </select>
      `;
      container.appendChild(div);
    });

    document.getElementById('testForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const email = formData.get('email');
      let total = 0;
      for (let i = 1; i <= preguntas.length; i++) {
        total += parseInt(formData.get(`q${i}`));
      }

      let resultado = '';
      if (total <= 50) {
        resultado = 'Tu perfil muestra bajo desarrollo estoico. Podr√≠as beneficiarte de reflexionar sobre tus reacciones y tu aceptaci√≥n del mundo tal como es.';
      } else if (total <= 70) {
        resultado = 'Tienes una base moderada de principios estoicos. Est√°s en el camino hacia mayor equilibrio interior.';
      } else {
        resultado = 'Demuestras un alto alineamiento con valores estoicos como autodominio, raz√≥n y aceptaci√≥n.';
      }

      fetch('https://test-personalidad.onrender.com/send-email', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email: email, resultado: resultado })
      });

      document.getElementById('paymentSection').classList.remove('d-none');
    });
  </script>
</body>
</html>
