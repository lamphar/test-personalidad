<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test de Estoicismo Interactivo</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body {
      background: linear-gradient(to right, #f8f9fa, #e0f7fa);
      font-family: 'Segoe UI', sans-serif;
    }
    .card {
      border: none;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    .btn-primary {
      background-color: #00695c;
      border: none;
    }
    .btn-primary:hover {
      background-color: #004d40;
    }
    .btn-success {
      background-color: #43a047;
      border: none;
    }
    .btn-success:hover {
      background-color: #2e7d32;
    }
    .progress-bar {
      transition: width 0.3s;
    }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="card p-4">
      <h1 class="text-center mb-4">üßò Test Interactivo de Estoicismo</h1>
      <p class="text-center">Eval√∫a tu alineaci√≥n con principios estoicos como autocontrol, aceptaci√≥n y racionalidad. Cada respuesta cuenta. S√© sincero contigo mismo.</p>

      <div class="progress mb-4">
        <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%"></div>
      </div>

      <form id="testForm">
        <div id="questionContainer" class="mb-4"></div>

        <div class="d-grid gap-2">
          <button type="button" id="nextBtn" class="btn btn-primary">Siguiente</button>
        </div>

        <div id="finalSection" class="d-none">
          <div class="mb-3 mt-4">
            <label for="email" class="form-label">Introduce tu correo para recibir los resultados:</label>
            <input type="email" class="form-control" id="email" name="email" required>
          </div>

          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="terms" required>
            <label class="form-check-label" for="terms">
              Acepto los <a href="/terminos.html" target="_blank">t√©rminos y condiciones</a> y la <a href="/privacidad.html" target="_blank">pol√≠tica de privacidad</a>.
            </label>
          </div>

          <button type="submit" class="btn btn-success w-100">Solicitar an√°lisis</button>
        </div>
      </form>

      <div id="paymentSection" class="mt-4 d-none">
        <div class="alert alert-info">
          <strong>¬°Gracias!</strong> Para sostener este servicio gratuito y cient√≠fico, te pedimos una cooperaci√≥n simb√≥lica de 0.50‚Ç¨.
        </div>
        <a href="https://buy.stripe.com/test_donation_link" class="btn btn-success w-100">Colaborar y recibir resultados</a>
        <p class="text-muted mt-2 text-center" style="font-size: 0.9em;">Sin suscripciones ocultas. Sin pagos recurrentes. Tu privacidad est√° segura.</p>
      </div>
    </div>
  </div>

<!-- ... [c√≥digo anterior sin cambios] ... -->
<script>
  const testEstoicismo = [
    "Suelo mantener la calma ante situaciones dif√≠ciles.",
    "Acepto aquello que no puedo controlar sin resistirme.",
    "Reflexiono antes de reaccionar emocionalmente.",
    "Me esfuerzo por ser virtuoso m√°s que exitoso.",
    "No me altero f√°cilmente por lo que otros opinan de m√≠.",
    "Evito el placer excesivo porque s√© que es ef√≠mero.",
    "Afronto el sufrimiento con dignidad.",
    "Soy disciplinado con mis h√°bitos diarios.",
    "Pongo la raz√≥n por encima del impulso.",
    "Encuentro sentido en actuar correctamente, incluso si nadie lo nota.",
    "Me preparo mentalmente para adversidades.",
    "Trato de conocerme a m√≠ mismo con honestidad.",
    "Encuentro libertad en aceptar mi destino.",
    "Reconozco mis errores sin juzgarme duramente.",
    "No envidio los logros materiales de los dem√°s.",
    "Agradezco lo que tengo, aunque sea poco.",
    "S√© distinguir entre deseo y necesidad.",
    "Me esfuerzo por mantenerme ecu√°nime.",
    "Uso las dificultades como oportunidades para crecer.",
    "Valoro m√°s la paz interior que el reconocimiento externo."
  ];

  const testAutoestima = [
    "Siento que soy una persona digna de aprecio, al menos en igual medida que los dem√°s.",
    "Siento que tengo cualidades positivas.",
    "Soy capaz de hacer las cosas tan bien como la mayor√≠a de las personas.",
    "Tengo una actitud positiva hacia m√≠ mismo.",
    "Estoy satisfecho conmigo mismo.",
    "A veces siento que no soy bueno para nada.",
    "Me gustar√≠a tener m√°s respeto por m√≠ mismo.",
    "Hay veces en que realmente me siento in√∫til.",
    "A veces pienso que no soy una buena persona.",
    "En general, me considero una persona valiosa."
  ];

  const testResiliencia = [
    "Puedo adaptarme a los cambios con rapidez.",
    "Veo el lado positivo incluso en situaciones dif√≠ciles.",
    "Mantengo la calma bajo presi√≥n.",
    "Puedo tomar decisiones efectivas en momentos dif√≠ciles.",
    "Tengo confianza en mi capacidad para enfrentar problemas.",
    "Me recupero r√°pidamente de decepciones.",
    "Encuentro maneras de crecer a partir de las dificultades.",
    "Mantengo una actitud positiva incluso cuando las cosas van mal.",
    "Soy capaz de seguir adelante despu√©s de fracasos.",
    "S√© cu√°ndo pedir ayuda y hacerlo me fortalece."
  ];

  let currentIndex = 0;
  let currentTest = [];
  let answers = [];

  const menuCard = document.getElementById('menuCard');
  const testCard = document.getElementById('testCard');
  const testTitle = document.getElementById('testTitle');
  const questionContainer = document.getElementById('questionContainer');
  const nextBtn = document.getElementById('nextBtn');
  const progressBar = document.getElementById('progressBar');

  function startTest(testName) {
    if (testName === 'estoicismo') {
      currentTest = testEstoicismo;
      testTitle.textContent = 'üßò Test de Estoicismo';
    } else if (testName === 'autoestima') {
      currentTest = testAutoestima;
      testTitle.textContent = 'üíñ Test de Autoestima';
    } else if (testName === 'resiliencia') {
      currentTest = testResiliencia;
      testTitle.textContent = 'üõ°Ô∏è Test de Resiliencia';
    }
    currentIndex = 0;
    answers = [];
    menuCard.classList.add('d-none');
    testCard.classList.remove('d-none');
    showQuestion(currentIndex);
  }

  function showQuestion(index) {
    questionContainer.innerHTML = `
      <label class="form-label">${currentTest[index]}</label>
      <select class="form-select" id="answer">
        <option value="1">Muy en desacuerdo</option>
        <option value="2">En desacuerdo</option>
        <option value="3">Ni de acuerdo ni en desacuerdo</option>
        <option value="4">De acuerdo</option>
        <option value="5">Muy de acuerdo</option>
      </select>
    `;
    progressBar.style.width = `${(index / currentTest.length) * 100}%`;
  }

  nextBtn.addEventListener('click', () => {
    const selected = document.getElementById('answer').value;
    answers.push(parseInt(selected));
    currentIndex++;
    if (currentIndex < currentTest.length) {
      showQuestion(currentIndex);
    } else {
      nextBtn.classList.add('d-none');
      document.getElementById('finalSection').classList.remove('d-none');
      questionContainer.classList.add('d-none');
      progressBar.style.width = '100%';
    }
  });

  document.getElementById('testForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const email = document.getElementById('email').value;
    const total = answers.reduce((a, b) => a + b, 0);
    let resultado = '';

    if (currentTest === testEstoicismo) {
      if (total <= 50) {
        resultado = 'Tu perfil muestra bajo desarrollo estoico. Podr√≠as beneficiarte de reflexionar sobre tus reacciones y tu aceptaci√≥n del mundo tal como es.';
      } else if (total <= 70) {
        resultado = 'Tienes una base moderada de principios estoicos. Est√°s en el camino hacia mayor equilibrio interior.';
      } else {
        resultado = 'Demuestras un alto alineamiento con valores estoicos como autodominio, raz√≥n y aceptaci√≥n.';
      }
    } else if (currentTest === testAutoestima) {
      if (total <= 25) {
        resultado = 'Tu nivel de autoestima parece estar por debajo del promedio. Puede ser √∫til trabajar en la autovaloraci√≥n con apoyo o reflexi√≥n.';
      } else if (total <= 35) {
        resultado = 'Tu autoestima es moderada. Est√°s en proceso de construir una imagen propia m√°s s√≥lida.';
      } else {
        resultado = 'Tu autoestima parece estar bien desarrollada. Tienes una percepci√≥n saludable de ti mismo.';
      }
    } else if (currentTest === testResiliencia) {
      if (total <= 25) {
        resultado = 'Tu resiliencia es baja. Trabajar en estrategias de afrontamiento puede ayudarte a desarrollar m√°s fortaleza interna.';
      } else if (total <= 35) {
        resultado = 'Tienes una resiliencia moderada. Est√°s construyendo habilidades para afrontar la adversidad.';
      } else {
        resultado = 'Tu resiliencia es alta. Sabes adaptarte, resistir y aprender de las dificultades con fortaleza.';
      }
    }

    fetch('https://test-personalidad.onrender.com/send-email', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email: email, resultado: resultado })
    });

    document.getElementById('paymentSection').classList.remove('d-none');
  });
</script>

</body>
</html>
